---
- name: Install gawk
  package:
    name: gawk
    state: present
- name: Clone repo

  git:
    repo: https://github.com/searxng/searxng
    dest: searxng
    force: true

- name: Install
  command: "{{ item }}"
  with_items:
    - FORCE_TIMEOUT=0 ./searxng/utils/searxng.sh install all
  changed_when: true

- name: Transfer searx config
  copy:
    src: searx.yml
    dest: /etc/searxng/settings.yml

- name: Enable and restart uwsgi
  service:
    name: uwsgi
    enabled: true
    state: restarted
