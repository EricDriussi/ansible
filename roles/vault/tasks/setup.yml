---
- name: Admin Token
  block:
    - name: Install packages
      import_role:
        name: common_roles/install_latest
      vars:
        packages: "argon2"

    - name: Create admin admin_token
      shell:
        cmd: |
          set -o pipefail
          echo -n "{{ vaultwarden_password }}" | argon2 "$(openssl rand -base64 32)" -e -id -k 19456 -t 2 -p 1
        executable: /bin/bash
      register: admin_token
      changed_when: true

- name: Setup docker
  import_role:
    name: common_roles/docker
