---
- hosts: root

  vars_files:
    - .env.yml

  roles:
    - role: user
      tags:
        - user

- hosts: ansible
  become: true

  vars_files:
    - .env.yml

  roles:
    - role: ssh
      tags:
        - ssh

    - role: custom
      tags:
        - custom

    - role: provision
      tags:
        - provision

    - role: fail2ban
      tags:
        - ban

- name: NEXTCLOUD
  tags: nextcloud
  hosts: ansible
  become: true
  tasks:
    - import_tasks: tasks/nextcloud.yml

- name: VAULT
  tags: vault
  hosts: ansible
  tasks:
    - import_tasks: tasks/vault.yml

- name: SEARX
  tags: searx
  hosts: ansible
  become: true
  tasks:
    - import_tasks: tasks/searx.yml

- name: SYNC WEBSITE
  tags: website
  hosts: ansible
  tasks:
    - import_tasks: tasks/sync-website.yml

- name: ONION
  tags: onion
  hosts: ansible
  become: true
  tasks:
    - import_tasks: tasks/onion.yml

- name: NGINX
  tags: nginx
  hosts: ansible
  become: true
  tasks:
    - import_tasks: tasks/nginx.yml
